

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial 07 - Signal interactions &mdash; nept 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="nept 0.1.0 documentation" href="../index.html"/>
        <link rel="up" title="Tutorials" href="index.html"/>
        <link rel="next" title="Tutorial 08 - MedPC behavior" href="Tutorial08_MedPC-behavior.html"/>
        <link rel="prev" title="Tutorial 06 - Pairwise co-occurrence" href="Tutorial06_Pairwise-co-occurrence.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> nept
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#interactive">Interactive</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#contributing-and-expanding-the-tutorial-scope">Contributing and expanding the tutorial scope</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#nept-tutorials">nept tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Tutorial01_Principles-of-(neural)-data-analysis.html">Tutorial 01 - Principles of careful (neural) data analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="Tutorial02_Setting-up.html">Tutorial 02 - Setting up</a></li>
<li class="toctree-l3"><a class="reference internal" href="Tutorial03_Data-types.html">Tutorial 03 - Introduction to neural data types</a></li>
<li class="toctree-l3"><a class="reference internal" href="Tutorial04_Handling-spiking-data.html">Tutorial 04 - Handling spiking data</a></li>
<li class="toctree-l3"><a class="reference internal" href="Tutorial05_Tuning-curves-and-decoding.html">Tutorial 05 - Tuning curves and decoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="Tutorial06_Pairwise-co-occurrence.html">Tutorial 06 - Pairwise co-occurrence</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Tutorial 07 - Signal interactions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Goals">Goals</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Coherence">Coherence</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Coherence-within-the-ventral-striatum-(vStr)-and-between-vStr-and-hippocampus-(hipp)">Coherence within the ventral striatum (vStr) and between vStr and hippocampus (hipp)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Compute-vStr-Hipp-coherence-between-experimental-conditions">Compute vStr-Hipp coherence between experimental conditions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Tutorial08_MedPC-behavior.html">Tutorial 08 - MedPC behavior</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../core.html">nept Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">nept Modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">nept</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Tutorials</a> &raquo;</li>
        
      <li>Tutorial 07 - Signal interactions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/Tutorial07_Signal-interactions.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Tutorial-07---Signal-interactions">
<h1>Tutorial 07 - Signal interactions<a class="headerlink" href="#Tutorial-07---Signal-interactions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Goals">
<h2>Goals<a class="headerlink" href="#Goals" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Compute the Power Spectrum Density (PSD) and coherence between two
signals</li>
<li>Compute vStr-Hipp coherence between experimental conditions</li>
</ul>
</div>
<div class="section" id="Coherence">
<h2>Coherence<a class="headerlink" href="#Coherence" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s start by considering how two oscillating signals may be related.
There are various possible relationships between the two, such as
illustrated here (from <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/22233726">Siegel et al.
2012</a>):</p>
</div>
<div class="section" id="Coherence-within-the-ventral-striatum-(vStr)-and-between-vStr-and-hippocampus-(hipp)">
<h2>Coherence within the ventral striatum (vStr) and between vStr and hippocampus (hipp)<a class="headerlink" href="#Coherence-within-the-ventral-striatum-(vStr)-and-between-vStr-and-hippocampus-(hipp)" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Import necessary packages</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nept</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.mlab</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span>

<span class="c1"># Define where your data folder is located</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">data_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s1">&#39;R016-2012-10-03&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Load the info file, which contains experiment-specific information</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_folder</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">r016d3</span> <span class="k">as</span> <span class="nn">info</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Load both LFPs (.ncs) from rat ventral striatum and one from the hippocampus</span>
<span class="n">lfp_vstr1</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">load_lfp</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">lfp_gamma_filename1</span><span class="p">))</span>
<span class="n">lfp_vstr2</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">load_lfp</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">lfp_gamma_filename2</span><span class="p">))</span>

<span class="n">lfp_hipp</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">load_lfp</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">lfp_theta_filename</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Let&#39;s restrict our LFPs to during task times</span>
<span class="n">task_start</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">task_times</span><span class="p">[</span><span class="s1">&#39;task-value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
<span class="n">task_stop</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">task_times</span><span class="p">[</span><span class="s1">&#39;task-reward&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span>

<span class="n">lfp_vstr1</span> <span class="o">=</span> <span class="n">lfp_vstr1</span><span class="o">.</span><span class="n">time_slice</span><span class="p">(</span><span class="n">task_start</span><span class="p">,</span> <span class="n">task_stop</span><span class="p">)</span>
<span class="n">lfp_vstr2</span> <span class="o">=</span> <span class="n">lfp_vstr2</span><span class="o">.</span><span class="n">time_slice</span><span class="p">(</span><span class="n">task_start</span><span class="p">,</span> <span class="n">task_stop</span><span class="p">)</span>
<span class="n">lfp_hipp</span> <span class="o">=</span> <span class="n">lfp_hipp</span><span class="o">.</span><span class="n">time_slice</span><span class="p">(</span><span class="n">task_start</span><span class="p">,</span> <span class="n">task_stop</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Plot the LFPs. Notice the break in LFP when the task was switched from &#39;value&#39; to &#39;reward&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lfp_vstr1</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">lfp_vstr1</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lfp_vstr2</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">lfp_vstr2</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lfp_hipp</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">lfp_hipp</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial07_Signal-interactions_8_0.png" src="../_images/tutorials_Tutorial07_Signal-interactions_8_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Compute the Power Spectral Density (PSD) for each signal with Welch’s average</span>
<span class="n">window</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="n">vstr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">lfp_vstr1</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">vstr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">lfp_vstr2</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">hipp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">lfp_hipp</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># Theta</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="c1"># Gamma</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">lfp_data</span> <span class="ow">in</span> <span class="p">[</span><span class="n">vstr1</span><span class="p">,</span> <span class="n">vstr2</span><span class="p">,</span> <span class="n">hipp</span><span class="p">]:</span>
    <span class="n">power</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">mlab</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">lfp_data</span><span class="p">,</span>
                                      <span class="n">Fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span>
                                      <span class="n">NFFT</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">window</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
                                      <span class="n">noverlap</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">window</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">power_db</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">power</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">power_db</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">85</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power (dB)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;vStr1&#39;</span><span class="p">,</span> <span class="s1">&#39;vStr2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hipp&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial07_Signal-interactions_9_0.png" src="../_images/tutorials_Tutorial07_Signal-interactions_9_0.png" />
</div>
</div>
<p>Notice the hippocampus has a clear theta (4 - 12 Hz) peak, which is
visible as only a slight hump in ventral striatum. Ventral striatum has
large gamma (25 - 100 Hz) components, which are not present in the
hippocampus.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Compute the coherence for vStr-vStr and vStr-hipp</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># Theta</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="c1"># Gamma</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">lfp_data</span> <span class="ow">in</span> <span class="p">[</span><span class="n">vstr2</span><span class="p">,</span> <span class="n">hipp</span><span class="p">]:</span>
    <span class="n">coherence</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">mlab</span><span class="o">.</span><span class="n">cohere</span><span class="p">(</span>
        <span class="n">vstr1</span><span class="p">,</span> <span class="n">lfp_data</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">window</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span> <span class="n">noverlap</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">window</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">coherence</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Coherence&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;vStr1-vStr2&#39;</span><span class="p">,</span> <span class="s1">&#39;vStr1-Hipp&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial07_Signal-interactions_11_0.png" src="../_images/tutorials_Tutorial07_Signal-interactions_11_0.png" />
</div>
</div>
<p>The coherence between the two ventral striatum signals is high overall
compared to that between the ventral striatum and hippocampus. The
ventral striatum gamma frequencies are particularly coherent within the
ventral striatum.</p>
</div>
<div class="section" id="Compute-vStr-Hipp-coherence-between-experimental-conditions">
<h2>Compute vStr-Hipp coherence between experimental conditions<a class="headerlink" href="#Compute-vStr-Hipp-coherence-between-experimental-conditions" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Load events from this experiment</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">load_events</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">event_filename</span><span class="p">),</span> <span class="n">info</span><span class="o">.</span><span class="n">event_labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let&#8217;s see if there is a change in coherence between <em>approach to the
reward site</em> and <em>reward receipt</em>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Get the photobeam break times</span>
<span class="n">pb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">events</span><span class="p">[</span><span class="s1">&#39;feeder0&#39;</span><span class="p">],</span> <span class="n">events</span><span class="p">[</span><span class="s1">&#39;feeder1&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Compute the perievent slices for the nosepoke times</span>
<span class="n">np_vstr1</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">perievent_slice</span><span class="p">(</span><span class="n">lfp_vstr1</span><span class="p">,</span> <span class="n">pb</span><span class="p">,</span> <span class="n">t_before</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">t_after</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">np_vstr2</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">perievent_slice</span><span class="p">(</span><span class="n">lfp_vstr2</span><span class="p">,</span> <span class="n">pb</span><span class="p">,</span> <span class="n">t_before</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">t_after</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">np_hipp</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">perievent_slice</span><span class="p">(</span><span class="n">lfp_hipp</span><span class="p">,</span> <span class="n">pb</span><span class="p">,</span> <span class="n">t_before</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">t_after</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Get the mean PSD for each of our signals</span>
<span class="n">freq</span><span class="p">,</span> <span class="n">psd_vstr1</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">mean_psd</span><span class="p">(</span><span class="n">np_vstr1</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">freq</span><span class="p">,</span> <span class="n">psd_vstr2</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">mean_psd</span><span class="p">(</span><span class="n">np_vstr2</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">freq</span><span class="p">,</span> <span class="n">psd_hipp</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">mean_psd</span><span class="p">(</span><span class="n">np_hipp</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Plot the PSDs</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">nept</span><span class="o">.</span><span class="n">power_in_db</span><span class="p">(</span><span class="n">psd_vstr1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">nept</span><span class="o">.</span><span class="n">power_in_db</span><span class="p">(</span><span class="n">psd_vstr2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">nept</span><span class="o">.</span><span class="n">power_in_db</span><span class="p">(</span><span class="n">psd_hipp</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">110</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power (dB)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;vStr1&#39;</span><span class="p">,</span> <span class="s1">&#39;vStr2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hipp&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial07_Signal-interactions_19_0.png" src="../_images/tutorials_Tutorial07_Signal-interactions_19_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Get the mean PSD for our signals of interest, e.g. vStr1-vStr2 and vStr1-Hipp</span>
<span class="n">freq</span><span class="p">,</span> <span class="n">csd_vstr1_vstr2</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">mean_csd</span><span class="p">(</span><span class="n">np_vstr1</span><span class="p">,</span> <span class="n">np_vstr2</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">freq</span><span class="p">,</span> <span class="n">csd_vstr1_hipp</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">mean_csd</span><span class="p">(</span><span class="n">np_vstr1</span><span class="p">,</span> <span class="n">np_hipp</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Plot the CSDs</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">nept</span><span class="o">.</span><span class="n">power_in_db</span><span class="p">(</span><span class="n">csd_vstr1_vstr2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">nept</span><span class="o">.</span><span class="n">power_in_db</span><span class="p">(</span><span class="n">csd_vstr1_hipp</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power (dB)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;vStr1-vStr2&#39;</span><span class="p">,</span> <span class="s1">&#39;vStr1-Hipp&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/home/emily/miniconda3/envs/py33/lib/python3.4/site-packages/numpy/core/numeric.py:482: ComplexWarning: Casting complex values to real discards the imaginary part
  return array(a, dtype, copy=False, order=order)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial07_Signal-interactions_21_1.png" src="../_images/tutorials_Tutorial07_Signal-interactions_21_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Get the mean coherence for our signals of interest, e.g. vStr1-vStr2 and vStr1-Hipp</span>
<span class="n">freq</span><span class="p">,</span> <span class="n">coh_vstr1_vstr2</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">mean_coherence</span><span class="p">(</span><span class="n">np_vstr1</span><span class="p">,</span> <span class="n">np_vstr2</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">freq</span><span class="p">,</span> <span class="n">coh_vstr1_hipp</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">mean_coherence</span><span class="p">(</span><span class="n">np_vstr1</span><span class="p">,</span> <span class="n">np_hipp</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Plot the coherences</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">coh_vstr1_vstr2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">coh_vstr1_hipp</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Coherence&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;vStr1-vStr2&#39;</span><span class="p">,</span> <span class="s1">&#39;vStr1-Hipp&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial07_Signal-interactions_23_0.png" src="../_images/tutorials_Tutorial07_Signal-interactions_23_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Get the mean coherencegram for our signals of interest, e.g. vStr1-vStr2 and vStr1-Hipp</span>
<span class="n">time</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">coherencegram_vstr1_vstr2</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">mean_coherencegram</span><span class="p">(</span><span class="n">np_vstr1</span><span class="p">,</span> <span class="n">np_vstr2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span>
                                                                <span class="n">window</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">time</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">coherencegram_vstr1_hipp</span> <span class="o">=</span> <span class="n">nept</span><span class="o">.</span><span class="n">mean_coherencegram</span><span class="p">(</span><span class="n">np_vstr1</span><span class="p">,</span> <span class="n">np_hipp</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span>
                                                               <span class="n">window</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Plot the vStr1-vStr2 coherencegram</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">freq</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">coherencegram_vstr1_vstr2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial07_Signal-interactions_25_0.png" src="../_images/tutorials_Tutorial07_Signal-interactions_25_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Plot the vStr1-Hipp coherencegram</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">freq</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">coherencegram_vstr1_hipp</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial07_Signal-interactions_26_0.png" src="../_images/tutorials_Tutorial07_Signal-interactions_26_0.png" />
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Tutorial08_MedPC-behavior.html" class="btn btn-neutral float-right" title="Tutorial 08 - MedPC behavior" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Tutorial06_Pairwise-co-occurrence.html" class="btn btn-neutral" title="Tutorial 06 - Pairwise co-occurrence" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2017, van der Meer lab.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>